<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Automated firmware updates &mdash; python-hpilo 4.4.3 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Managing iLO’s with puppet" href="puppet.html" />
    <link rel="prev" title="iLO information search" href="elasticsearch.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            python-hpilo
              <img src="_static/python-hpilo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                4.4.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing python-hpilo</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Access from Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell.html">Access from the shell</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="info.html">General server and iLO information</a></li>
<li class="toctree-l1"><a class="reference internal" href="networksettings.html">Network settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">iLO licensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security and SSL settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="health.html">Server health</a></li>
<li class="toctree-l1"><a class="reference internal" href="power.html">Power manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="boot.html">Boot settings and rebooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="media.html">Virtual media</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Keyboard and mouse settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="snmp.html">SNMP settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="firmware.html">Dealing with iLO firmware updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="xmldata.html">Unauthenticated iLO and Chassis OA data</a></li>
<li class="toctree-l1"><a class="reference internal" href="log.html">iLO event log</a></li>
<li class="toctree-l1"><a class="reference internal" href="federation.html">Federation groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="ahs.html">Active Health System and Insight Remote Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="profile.html">Deployment profiles</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ca.html">Managing SSL certificates</a></li>
<li class="toctree-l1"><a class="reference internal" href="elasticsearch.html">iLO information search</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Automated firmware updates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#scheduling-updates">Scheduling updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checking-the-queue">Checking the queue</a></li>
<li class="toctree-l2"><a class="reference internal" href="#doing-the-upgrades">Doing the upgrades</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="puppet.html">Managing iLO’s with puppet</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Common issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">python-hpilo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Automated firmware updates</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="automated-firmware-updates">
<h1>Automated firmware updates<a class="headerlink" href="#automated-firmware-updates" title="Permalink to this headline">¶</a></h1>
<p>Building on the <a class="reference internal" href="elasticsearch.html"><span class="doc">Elasticsearch</span></a> example, we can now build
automated updates for iLO firmware.</p>
<p>The example application uses <a class="reference external" href="http://kr.github.io/beanstalkd/">beanstalk</a> and <a class="reference external" href="http://github.com/seveas/azuki">azuki</a> to queue firmware
updates and process them with as much parallelism as you want.</p>
<div class="section" id="scheduling-updates">
<h2>Scheduling updates<a class="headerlink" href="#scheduling-updates" title="Permalink to this headline">¶</a></h2>
<p>If you run <strong class="command">hpilo_firmware_update</strong>, it will query elasticsearch to
find iLOs with obsolete firmware and schedule updates. It’s probably most
useful to run this command in the same cronjob as the elasticsearch importer to
schedule firmware updates as they come in.</p>
</div>
<div class="section" id="checking-the-queue">
<h2>Checking the queue<a class="headerlink" href="#checking-the-queue" title="Permalink to this headline">¶</a></h2>
<p>Using the <strong class="command">azuki</strong> tool, you can check how many iLOs need to be upgraded:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ azuki stats hpilo-upgrades
hpilo-upgrades
Connections:
    Producers:   0
    Consumers:   1
    Waiting:     0
Jobs:
    Delayed:     0
    Ready:       1
    Urgent:      0
    Reserved:    1
    Buried:      0
    Deleted:     11
    Total:       13
</pre></div>
</div>
</div>
<div class="section" id="doing-the-upgrades">
<h2>Doing the upgrades<a class="headerlink" href="#doing-the-upgrades" title="Permalink to this headline">¶</a></h2>
<p>To process the queue, you again use azuki:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ azuki daemon hpilo-upgrades
INFO:azuki:Waiting for job
Upgrading example-server-1.int.kaarsemaker.net (10.10.10.42) from ilo3 1.70 to ilo3 1.85
...
</pre></div>
</div>
<p>This will keep running and process new items as they come in. You’ll probably
want to run it in screen or tmux so it stays on in the background. If you have
lots of iLOs to upgrade, you can start as many instances of this as you want,
they will not step on each others toes. I regularly run up to 30 instances in
parallel in a tmux session.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="elasticsearch.html" class="btn btn-neutral float-left" title="iLO information search" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="puppet.html" class="btn btn-neutral float-right" title="Managing iLO’s with puppet" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2020, Dennis Kaarsemaker.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>